<aura:component controller="WorkTeamController">
    <aura:handler name="init" action="{!c.getWorkTeam}" value="{!this}"/>
	<aura:attribute name="WorkTeamID"
                    type="String" />
    
    <aura:attribute name="WorkTeam"
                    type="WorkTeam__c"
                    default="{'Name':'','Team_Queue__c':''}" />
    <aura:attribute name="WorkTeamParent"
                    type="WorkTeam__c"
                    default="{'Name':''}" />
    <aura:attribute name="WorkTeamParents"
                    type="List"
                    default="[]" />
    <aura:attribute name="Manager"
                    type="User"
                    default="{'Profile':{'UserLicense':{'Name':'Salesforce'}},
                              'Name':''}" />
    <aura:attribute name="Managers"
                    type="List"
                    default="[]" />
    <aura:attribute name="messageHelp"
                    type="String" />
    <aura:attribute name="closeWindows"
                    type="Boolean"
                    default="False"/>
    
    <aura:attribute name="showWorkTeamList"
                    type="Boolean"
                    default="true"/>
    <aura:attribute name="showWorkTeamCreate"
                    type="Boolean"
                    default="false"/>
    <aura:attribute name="showWorkTeamDetail"
                    type="Boolean"
                    default="false"/>
    <aura:registerEvent name="WorkTeamDetailEventFired" type="c:WorkTeamDetailEvent"/>
    
    <div class="body__c">
        <h1>{! $Label.c.Work_Team_New_Title_Page }</h1>
        <div class="slds-form slds-form_stacked">
            <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                <lightning:input name="Name" value="{! v.WorkTeam.Name }" placeholder="{! $Label.c.Work_Team_New_Name_Label }" label="{! $Label.c.Work_Team_New_Name_Label +':' }" required="true"/>
            </div>
            <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                    <lightning:select aura:id="userType" name="userType" label="{! $Label.c.Work_Team_New_Manager_Label + ':' }" onchange="{! c.onChangeUserType }">
                        <aura:if isTrue="{! v.Manager.Profile.UserLicense.Name == 'Salesforce'}"><option value="user" selected="true">User</option></aura:if>
                        <aura:if isTrue="{! v.Manager.Profile.UserLicense.Name == 'Partner Commuinty'}"><option value="partner" selected="true">Partner User</option></aura:if>
                        <aura:if isTrue="{! v.Manager.Profile.UserLicense.Name == 'ustomer Community'}"><option value="portal" selected="true">Customer Portal User</option></aura:if>
                    </lightning:select>
                </div>
                <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                    <lightning:input name="Manager" value="{! v.Manager.Name }" placeholder="{! $Label.c.Work_Team_New_Manager_Name_Label }" label="" />
                    <span class="search__c" onclick="{! c.searchUser }"><lightning:icon iconName="utility:search" alternativeText="Buscar" variant="success"/></span>
                </div>
            </div>
            <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                <div class="input__c slds-max-small-size--6-of-6 slds-size--6-of-6">
                	<lightning:input name="ParentName" value="{! v.WorkTeamParent.Name }" placeholder="{! $Label.c.Work_Team_Parent_Name_Label }" label="{! $Label.c.Work_Team_Parent_Name_Label +':'}" />
                	<span class="search__c search__c2" onclick="{! c.searchWorkTeams }"><lightning:icon iconName="utility:search" alternativeText="Buscar" variant="success"/></span>
                </div>
            </div>
            <div class="input__c slds-max-small-size--6-of-6 slds-size--3-of-6">
                <lightning:input name="TeamQueue" value="{! v.WorkTeam.Team_Queue__c }" placeholder="{! $Label.c.Work_Team_Queue_Label }" label="{! $Label.c.Work_Team_Queue_Label + ':' }" />
            </div>
            <aura:if isTrue="{! v.WorkTeamID }">
                <div class="input__c slds-max-small-size--6-of-6 slds-size--6-of-6">
                    <lightning:input type="toggle" 
                             label="{! v.WorkTeam.LabelWorkTeamIsActive }"
                             name="isActive"
                             class="slds-p-around--small"
                             checked="{! v.WorkTeam.Is_Active__c }"
                             messageToggleActive="Active"
                             messageToggleInactive="Inactive"/>
                </div>
            </aura:if>
        </div>
        <div class="slds-form slds-form_stacked button__c">
        	<lightning:buttonGroup >
                <lightning:button variant="neutral" label="{! $Label.c.Work_Team_Cancel_Button }" onclick="{! c.cancelWorkTeam }" />
                <lightning:button variant="brand" label="{! $Label.c.Work_Team_Save_Button }" onclick="{! c.saveWorkTeam }" />
             </lightning:buttonGroup>
        </div>
    </div>
    
    <div id="usersModal__c" class="users" style="display: none;">
      <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
          <header class="slds-modal__header">
            <h2 id="headerUsersModal__c" class="slds-text-heading_medium slds-hyphenate">{! $Label.c.Work_Team_New_Title_User_Modal }</h2>
          </header>
          <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
              <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                  <thead>
                      <tr class="slds-text-title_caps">
                          <th scope="col">
                            <div class="slds-truncate" title="Name">Name</div>
                          </th>
                          <th scope="col">
                            <div class="slds-truncate" title="Name">Role</div>
                          </th>
                          <th scope="col">
                            <div class="slds-truncate" title="Name">Profile</div>
                          </th>
                          <th scope="col">
                            <div class="slds-truncate" title="Name">Legajo</div>
                          </th>
                      </tr>
                  </thead>
                  <tbody>
                      <aura:iteration items="{!v.Managers}" var="mngr" indexVar="index">
                          <tr>
                              <th scope="row" data-label="Name">
                                <div class="slds-truncate" title="{! mngr.Name }">
                                    <lightning:button variant="base" label="{! mngr.Name }" title="{! mngr }" onclick="{! c.selectThisManager }"/>
                                </div>
                              </th>
                              <th scope="row" data-label="Role">
                                <div class="slds-truncate" title="{! mngr.UserRole.Name }">
                                    <lightning:button variant="base" label="{! mngr.UserRole.Name }" title="{! mngr }" onclick="{! c.selectThisManager }"/>
                                </div>
                              </th>
                              <th scope="row" data-label="Profile">
                                <div class="slds-truncate" title="{! mngr.Profile.Name }">
                                    <lightning:button variant="base" label="{! mngr.Profile.Name }" title="{! mngr }" onclick="{! c.selectThisManager }"/>
                                </div>
                              </th>
                              <th scope="row" data-label="Legajo">
                                <div class="slds-truncate" title="{! mngr.FederationIdentifier }">
                                    <lightning:button variant="base" label="{! mngr.FederationIdentifier }" title="{! mngr }" onclick="{! c.selectThisManager }"/>
                                </div>
                              </th>
                          </tr>
                      </aura:iteration>
                  </tbody>
              </table>
          </div>
          <footer class="slds-modal__footer">
            <button class="slds-button slds-button_neutral" onclick="{! c.hiddenUsersModal }">{! $Label.c.Work_Team_Cancel_Button }</button>
          </footer>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    
    <div id="workTeamsModal__c" class="workTeams" style="display: none;">
      <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
          <header class="slds-modal__header">
            <h2 id="headerUsersModal__c" class="slds-text-heading_medium slds-hyphenate">Work Teams</h2>
          </header>
          <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
              <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                  <thead>
                      <tr class="slds-text-title_caps">
                          <th scope="col">
                            <div class="slds-truncate" title="Name">Name</div>
                          </th>
                      </tr>
                  </thead>
                  <tbody>
                      <aura:iteration items="{!v.WorkTeamParents}" var="wtp" indexVar="index">
                          <tr>
                              <th scope="row" data-label="Name">
                                <div class="slds-truncate" title="{! wtp.Name }">
                                    <lightning:button variant="base" label="{! wtp.Name }" title="{! wtp }" onclick="{! c.selectThisWorkTeam }"/>
                                </div>
                              </th>
                          </tr>
                      </aura:iteration>
                  </tbody>
              </table>
          </div>
          <footer class="slds-modal__footer">
            <button class="slds-button slds-button_neutral" onclick="{! c.hiddenWorkTeamsModal }">{! $Label.c.Work_Team_Cancel_Button }</button>
          </footer>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    
    <div id="message__helper" class="helper" style="display: none;">
      <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
          <header class="slds-modal__header">
            <h2 id="headerUsersModal__c" class="slds-text-heading_medium slds-hyphenate">Información</h2>
          </header>
          <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
              <p>{! v.messageHelp }</p>
          </div>
          <footer class="slds-modal__footer">
            <button class="slds-button slds-button_brand" onclick="{! c.hiddenMessageModal }">{! $Label.c.Work_Team_Submit_Button }</button>
          </footer>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </div>
    
    
	
</aura:component>